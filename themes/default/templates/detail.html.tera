<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ link_name | escape }} Â· {{ site_title | escape }}</title>
    {% if site_desc and site_desc != "" %}
    <meta name="description" content="{{ site_desc | escape }}">
    {% endif %}
    <link rel="icon" href="../../assets/favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="../../assets/styles.css">
  </head>
  <body class="theme-{{ color_scheme }}">
    <div class="top-actions">
      <button id="toggleTheme" class="btn ghost" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ“</button>
    </div>
    <header class="hero">
      <div class="hero-inner">
        <div class="hero-center">
          <div id="clock" class="clock">--:--</div>
          <a id="clock-date" class="clock-date" href="https://www.51wnl.com/webcalandar/index.html" target="_blank" rel="noopener"></a>
        </div>
        <div class="searchbar" style="height:1px"></div>
      </div>
    </header>

    <main class="container">
      <section class="group">
        <h2 class="group-title">å³å°†å‰å¾€ç¬¬ä¸‰æ–¹ç½‘ç«™</h2>
        <div class="card">
          <div class="card-head">
            {% if link_icon %}
            <img class="icon" src="{{ link_icon | escape }}" alt="">
            {% endif %}
            <div class="title">{{ link_name | escape }}</div>
          </div>
          <div class="meta">
            <span class="badge risk-{{ risk_class }}">é£é™©ç­‰çº§ï¼š{{ risk_label }}</span>
          </div>
          {% if link_details_html %}
          <div class="desc">{{ link_details_html | safe }}</div>
          {% elif link_intro and link_intro != "" %}
          <div class="desc">{{ link_intro | escape }}</div>
          {% endif %}
          {% if link_host and link_host != "" %}
          <div class="meta">ç›®æ ‡åŸŸåï¼š{{ link_host | escape }}</div>
          {% endif %}
          <div class="meta">ç›®æ ‡åœ°å€ï¼š<code>{{ link_url | escape }}</code></div>
          <div class="meta" id="cdWrap" style="display:none;">å°†äº <strong id="cd">{{ delay_seconds }}</strong> ç§’åè·³è½¬â€¦â€¦</div>
          <div style="margin-top:12px; display:flex; gap:8px;">
            <a class="btn" id="proceed" target="_self" rel="noopener noreferrer" href="{{ link_url | escape }}">ç»§ç»­å‰å¾€</a>
            <a class="btn" href="../../index.html">è¿”å›</a>
            {% if has_delay %}<button class="btn" id="cancelAuto" style="display:none;">å–æ¶ˆ</button>{% endif %}
          </div>
        </div>
      </section>

      <section class="group">
        <h2 class="group-title">é£é™©æç¤º</h2>
        <div class="card">
          <div class="desc">
            <ul>
              <li>ç¡®è®¤ç›®æ ‡åŸŸåæ˜¯å¦æ­£ç¡®ï¼š<code>{{ link_host | escape }}</code></li>
              <li>ä¼˜å…ˆè®¿é—® HTTPSï¼ˆåœ°å€æ åº”æ˜¾ç¤ºé”å½¢æ ‡è¯†ï¼‰ã€‚</li>
              <li>è°¨æ…è¾“å…¥è´¦å·ã€å¯†ç ã€éªŒè¯ç ç­‰æ•æ„Ÿä¿¡æ¯ã€‚</li>
              <li>å¦‚æ¥è‡ªä¸æ˜æ¥æºï¼Œè¯·å‹¿ä¸‹è½½æˆ–è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
            </ul>
          </div>
        </div>
      </section>
    </main>

    <script src="../../assets/app.js"></script>
    <script>
      (function(){
        var hasDelay = {{ has_delay | json_encode | safe }};
        var delay = {{ delay_seconds | json_encode | safe }} || 0;
        var url = {{ link_url | json_encode | safe }};
        var proceed = document.getElementById('proceed');
        var cdWrap = document.getElementById('cdWrap');
        var cd = document.getElementById('cd');
        var cancelBtn = document.getElementById('cancelAuto');
        var timer = null, remain = delay;

        if (proceed) {
          proceed.addEventListener('click', function(ev){
            if (!hasDelay || delay <= 0) { return; } // ç›´æ¥è®©æµè§ˆå™¨æŒ‰é»˜è®¤è·³è½¬
            ev.preventDefault();
            // æ˜¾ç¤ºå€’è®¡æ—¶å¹¶å¯åŠ¨
            cdWrap && (cdWrap.style.display = 'block');
            cancelBtn && (cancelBtn.style.display = 'inline-block');
            proceed.setAttribute('disabled', 'true');
            proceed.textContent = 'å‡†å¤‡è·³è½¬â€¦';
            remain = delay;
            if (cd) cd.textContent = String(remain);
            timer = setInterval(function(){
              remain -= 1;
              if (cd) cd.textContent = String(remain);
              if (remain <= 0) {
                clearInterval(timer); timer=null;
                window.location.href = url;
              }
            }, 1000);
          });
        }
        if (cancelBtn) {
          cancelBtn.addEventListener('click', function(){
            if (timer) { clearInterval(timer); timer=null; }
            proceed.removeAttribute('disabled');
            proceed.textContent = 'ç»§ç»­å‰å¾€';
            cdWrap && (cdWrap.style.display = 'none');
            cancelBtn.style.display = 'none';
          });
        }
      })();
    </script>
  </body>
</html>
